SELECT 
TB02055_CODIGO NumVenda,
CAST(TB02021_DATA AS DATE) DtVenda,
TB02021_VEND CodVendedor,
TB01006_NOME NomeVendedor,
TB02055_NUMSERIE NumSerie,
TB01010_NOME Produto,
TB02055_PRODUTO CodProd,
TB02021_VLRNOTA TotalValorVenda,
CAST((TB02021_VLRNOTA - ((TB02022_TOTVALOR * CASE WHEN TB01014_A.TB01014_TIPOPERC = 0 THEN TB02021_PERCCOND ELSE 0 END)/100)) * TB02022_COMISSAO/100 AS NUMERIC(11,2)) Comiss√£o

FROM TB02055
LEFT JOIN TB02021 ON TB02021_CODIGO = TB02055_CODIGO
	AND TB02021_CODEMP = TB02055_CODEMP
LEFT JOIN TB02022 ON TB02022_CODIGO = TB02055_CODIGO
	AND TB02022_PRODUTO = TB02055_PRODUTO
LEFT JOIN TB01010 ON TB01010_CODIGO = TB02055_PRODUTO
LEFT JOIN TB01006 ON TB01006_CODIGO = TB02021_VEND
LEFT JOIN TB02012 ON TB02022_PRODUTO = TB02012_PRODUTO
LEFT JOIN TB01014 AS TB01014_A ON TB01014_A.TB01014_CODIGO = TB02021_CONDPAG

WHERE TB02021_BONIF = 'N'
    AND TB02021_VLRSERV = 0
    AND TB02021_BONIF = 'N'
    AND TB02021_CUPOM = 'N'
	AND TB02055_OPERACAO = 'S'
	AND TB02021_VEND = @VEND
	AND TB02021_DATA BETWEEN @DE AND @ATE
